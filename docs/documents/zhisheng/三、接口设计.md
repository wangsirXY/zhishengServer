# 四、接口设计

## 1）功能模块

### 获取所有模块接口

> 请求地址：/func/funcModule
>
> 请求方式：POST

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "name": "遇见",
               "isshow": 0,
               "isdel": 0,
               "type": 1
           },
       ],
       "message": "获取模块数据成功"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "获取模块数据失败"
   }
   ```



### 获取模块分类接口

> 请求地址：/func/funcType
>
> 请求方式：POST

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 2,
               "name": "学习帮助",
               "isdel": 0,
               "item": [
                   {
                       "id": 8,
                       "name": "云自习",
                       "isshow": 1,
                       "isdel": 0,
                       "type": 2
                   },
               ]
           },
       ],
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "获取模块数据失败"
   }
   ```

   

## 2）用户模块

### 注册接口

> 请求地址：/users/register
>
> 请求方式：POST

| 请求参数 | 类型   | 说明       |
| -------- | ------ | ---------- |
| nickname | String | 昵称       |
| photo    | String | 头像       |
| gender   | String | 性别       |
| mobile   | String | 手机号     |
| password | String | 密码       |
| auth     | String | 短信验证码 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": {
           "id": 11
       },
       "message": "用户注册成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 201,
       "message": "用户已存在，无需注册"
   }
   ```



### 登录接口

> 请求地址：/users/login
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| mobile   | String | 手机号 |
| password | String | 密码   |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "登录成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 201,
       "message": "账号或密码错误，请重新输入！"
   }
   
   {
       "status": 0,
       "message": "用户不存在，请先注册账号！"
   }
   ```

   

### 用户信息查询

> 请求地址：/users/userInfo
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| mobile   | String | 手机号 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": {
           "id": 1,
           "name": "未实名",
           "identity": null,
           "nickname": "奇怪的大象",
           "photo": "123456",
           "gender": "女",
           "info": "我正在想一个炸裂地球的签名!",
           "mobile": "15766667777",
           "pwd": "123456",
           "auth": "123456",
           "email": null,
           "school": "未认证",
           "schoolID": null,
           "time": "2022-01-08T14:57:35.000Z",
           "isdel": 0,
           "honor": [
               {
                   "id": 1,
                   "name": "荣誉名称",
                   "info": "荣誉介绍",
                   "isdel": 0,
                   "user_fk": 1
               },
           ]
       },
       "message": "用户信息查询成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "用户信息不存在！"
   }
   ```

   

### 修改用户信息

> 请求地址：/users/updateinfo
>
> 请求方式：POST

| 请求参数 | 类型   | 说明                                                 |
| -------- | ------ | ---------------------------------------------------- |
| id       | Number | 用户ID                                               |
| field    | String | 要修改的字段名（只能传入用户表的字段，**严格校验**） |
| value    | String | 修改后的值                                           |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "用户信息修改成功！"
   }
   ```

2. 失败

   ```json
   /待定
   ```




### 添加用户荣誉

> 请求地址：/users/userAddhonor
>
> 请求方式：POST

| 请求参数 | 类型   | 说明     |
| -------- | ------ | -------- |
| name     | String | 荣誉名称 |
| info     | String | 荣誉介绍 |
| uid      | Number | 用户ID   |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "用户荣誉添加成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "数据不能为空！"
   }
   
   或
   
   {
       "status": 0,
       "message": "用户ID必须为Number类型！"
   }
   ```



### 修改荣誉信息

> 请求地址：/users/userUpdaethonor
>
> 请求方式：POST

| 请求参数 | 类型   | 说明     |
| -------- | ------ | -------- |
| id       | Number | 荣誉ID   |
| name     | String | 荣誉名称 |
| info     | String | 荣誉介绍 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "荣誉信息修成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "数据不能为空或0！"
   }
   ```

   

### 删除用户荣誉

> 请求地址：/users/userRemovehonor
>
> 请求方式：POST

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "删除荣誉成功！"
   }
   ```

2. 失败

   ```json
   
   ```

   

## 3）遇见模块

### 获取文章类别

> 请求地址：/article/artType
>
> 请求方式：POST

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "name": "生活",
               "isdel": 0
           },
       ],
       "message": "文章类别查询成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "文章类别无数据！"
   }
   ```

   

### 获取分类的文章

> 请求地址：/article/articleList
>
> 请求方式：POST

| 请求参数 | 是否必填 | 类型   | 说明       | 备注                        |
| -------- | -------- | ------ | ---------- | --------------------------- |
| id       | False    | Number | 文章类别ID | 默认值：0，代表查询所有文章 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "title": "欢迎来到知升！",
               "time": "2022-01-07T10:00:03.000Z",
               "text": "欢迎新同学来到知升，快和好朋友一起解锁新功能吧！",
               "isdel": 0,
               "user_fk": 1,
               "type_fk": 1
           },
       ],
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "当前类别文章无数据！"
   }
   ```




### 获取文章内容

> 请求地址：/article/article
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| id       | Number | 文章ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "title": "欢迎来到知升！",
               "time": "2022-01-07T10:00:03.000Z",
               "text": "欢迎新同学来到知升，快和好朋友一起解锁新功能吧！",
               "isdel": 0,
               "user_fk": 1,
               "type_fk": 1,
               "likeCount": 4,
               "collectCount": 4
           }
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "获取文章内容失败！"
   }
   ```

   

### 发表文章

> 请求地址：/article/artPub
>
> 请求方式：POST

| 请求参数 | 类型   | 说明       |
| -------- | ------ | ---------- |
| title    | String | 文章标题   |
| text     | String | 文章内容   |
| uid      | Number | 用户ID     |
| tid      | Number | 文章类别ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "文章发表成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "文章发表失败！"
   }
   ```




### 删除文章

> 请求地址：/article/artPub
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| id       | Number | 文章ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "删除文章成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "要删除的文章不存在！"
   }
   ```



### 获取文章评论

> 请求地址：/article/artDis
>
> 请求方式：POST

| 请求参数 | 是否必填 | 类型   | 说明   | 备注                    |
| -------- | -------- | ------ | ------ | ----------------------- |
| artid    | True     | Number | 文章ID |                         |
| reply    | False    | Number | 评论ID | 默认值：0，代表一级评论 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "time": "2022-01-07T16:18:27.000Z",
               "text": "这是一条评论！",
               "reply": 0,
               "isdel": 0,
               "art_fk": 1,
               "user_fk": 1
           },
       ],
       "message": "获取评论信息成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "当前没有评论！"
   }
   ```



### 添加评论

> 请求地址：/article/writeDis
>
> 请求方式：POST

| 请求参数 | 是否必填 | 类型   | 说明                       | 备注                    |
| -------- | -------- | ------ | -------------------------- | ----------------------- |
| text     | True     | String | 评论内容                   |                         |
| artid    | True     | Number | 文章ID                     |                         |
| uid      | True     | Number | 发表评论的用户ID           |                         |
| reply    | False    | Number | 二级评论：对应的一级评论ID | 默认值：0，代表一级评论 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "评论发表成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "必填字段不能为空！"
   }
   ```




### 删除评论

> 请求地址：/article/removeDis
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| id       | Number | 评论ID |

1. 成功

   ```json
   {
       "status": 200,
       "message": "评论已删除！"
   }
   ```

   

### 查询用户是否点赞文章

> 请求地址：/article/artSelike
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| artid    | Number | 文章ID |
| uid      | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "用户已经点赞了文章！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "用户未点赞文章！"
   }
   ```

   

### 文章点赞

> 请求地址：/article/artlike
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| artid    | Number | 文章ID |
| uid      | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "文章点赞成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "参数传递错误！"
   }
   
   或
   
   {
       "status": 0,
       "message": "参数传递错误，必须为Number类型！"
   }
   ```

   

### 文章取消点赞

> 请求地址：/article/artNolike
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| artid    | Number | 文章ID |
| uid      | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "文章已取消点赞！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "参数传递错误！"
   }
   
   或
   
   {
       "status": 0,
       "message": "参数传递错误，必须为Number类型！"
   }
   ```

   

### 查询用户是否收藏文章

> 请求地址：/article/artSecollect
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| artid    | Number | 文章ID |
| uid      | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "用户已经收藏了文章！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "用户未收藏文章！"
   }
   ```

   

### 收藏文章

> 请求地址：/article/artcollect
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| artid    | Number | 文章ID |
| uid      | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "文章收藏成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "参数传递错误！"
   }
   
   或
   
   {
       "status": 0,
       "message": "参数传递错误，必须为Number类型！"
   }
   ```

   

### 取消收藏文章

> 请求地址：/article/artNocollect
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| artid    | Number | 文章ID |
| uid      | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "文章已取消收藏！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "参数传递错误！"
   }
   
   或
   
   {
       "status": 0,
       "message": "参数传递错误，必须为Number类型！"
   }
   ```




## 4）就业规划模块

### 获取一级分类

> 请求地址：/workrules/oneType
>
> 请求方式：POST

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": {
           "id": 1,
           "name": "就业",
           "isdel": 0
       },
       "message": "获取一级分类成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "一级分类无数据！"
   }
   ```



### 获取二级分类

> 请求地址：/workrules/twoType
>
> 请求方式：POST

| 请求参数 | 类型   | 说明       |
| -------- | ------ | ---------- |
| id       | Number | 一级分类ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "name": "公司",
               "isdel": 0,
               "one_fk": 1
           },
       ],
       "message": "获取二级分类成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "二级分类无数据！"
   }
   ```



### 获取就业规划内容/文章列表

> 请求地址：/workrules/ruleGetartList
>
> 请求方式：POST

| 请求参数 | 类型   | 说明       |
| -------- | ------ | ---------- |
| id       | Number | 二级分类ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "title": "华为",
               "scale": "10000人以上",
               "genre": "计算机软件",
               "info": "公司描述",
               "text": "公司详细信息",
               "pageview": 0,
               "time": "2022-01-09T13:08:22.000Z",
               "isdel": 0,
               "type_fk": 1,
               "img": [
                   {
                       "id": 1,
                       "img": "../image",
                       "isdel": 0,
                       "rules_fk": 1
                   }
               ]
           }
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "分类文章无数据！"
   }
   ```

   

### 添加就业规划内容/文章

> 请求地址：/workrules/ruleAddart
>
> 请求方式：POST

| 请求参数 | 是否必填 | 类型   | 说明             | 备注                                      |
| -------- | -------- | ------ | ---------------- | ----------------------------------------- |
| title    | True     | String | 标题/名称        |                                           |
| info     | True     | String | 简介描述         |                                           |
| text     | True     | String | 详细信息/正文    |                                           |
| tid      | True     | Number | 所属的二级分类ID |                                           |
| scale    | False    | String | 规模/人数        | 仅学校和公司填写。<br />格式：10000人以上 |
| genre    | False    | String | 公司业务类型     | 仅公司填写。<br />格式：计算机软件        |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "添加文章成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "必填字段未添加！"
   }
   
   或
   
   {
       "status": 200,
       "message": "二级分类ID必须为Number类型！"
   }
   ```

   

### 获取就业规划内容/文章详情

> 请求地址：/workrules/ruleGetart
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| id       | Number | 文章ID |

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "title": "华为",
               "scale": "10000人以上",
               "genre": "计算机软件",
               "info": "公司描述",
               "text": "公司详细信息",
               "pageview": 0,
               "time": "2022-01-09T13:08:22.000Z",
               "isdel": 0,
               "type_fk": 1,
               "img": [
                   {
                       "id": 1,
                       "img": "../image",
                       "isdel": 0,
                       "rules_fk": 1
                   }
               ],
               "comment": [
                   {
                       "id": 1,
                       "img": "../image",
                       "isdel": 0,
                       "rules_fk": 1
                   }
               ]
           }
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "文章不存在！"
   }
   ```

   

### 获取就业规划内容/文章 评论

> 请求地址：/workrules/ruleComment
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| id       | Number | 文章ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "time": "2022-01-09T15:33:44.000Z",
               "text": "这是一条评论",
               "reply": 0,
               "isdel": 0,
               "art_fk": 1,
               "user_fk": 1
           }
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "该文章没有评论！"
   }
   ```

   

### 添加就业规划内容/文章 评论

> 请求地址：/workrules/ruleAddComment
>
> 请求方式：POST

| 请求参数 | 是否必填 | 类型   | 说明         | 备注                   |
| -------- | -------- | ------ | ------------ | ---------------------- |
| text     | True     | String | 评论内容     |                        |
| aid      | True     | Number | 文章ID       |                        |
| uid      | True     | Number | 用户ID       |                        |
| reply    | False    | Number | 回复的评论ID | 默认值：0 代表一级评论 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "message": "评论发表成功！"
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "必填字段未添加！"
   }
   
   或
   
   {
       "status": 200,
       "message": "文章ID和用户ID必须为Number类型！"
   }
   ```




## 5）云自习模块

### 获取云自习类别

> 请求地址：/studytime/type
>
> 请求方式：POST

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "name": "语文",
               "isdel": 0
           },
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "云自习无自习类别数据！"
   }
   ```

   

### 获取自习室自习记录

> 请求地址：/studytime/record
>
> 请求方式：POST

| 请求参数 | 类型   | 说明   |
| -------- | ------ | ------ |
| id       | Number | 用户ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "name": "备战考研",
               "time": 120,
               "issucceed": 1,
               "createtime": "2022-01-10T03:32:14.000Z",
               "isdel": 0,
               "user_fk": 1
           },
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "当前没有自习记录！"
   }
   ```

   

### 获取自习代办清单

> 请求地址：/studytime/inventory
>
> 请求方式：POST

| 请求参数 | 类型   | 说明       |
| -------- | ------ | ---------- |
| id       | Number | 自习记录ID |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "id": 1,
               "name": "考研清单1",
               "issucceed": 1,
               "isdel": 0,
               "record_fk": 1
           },
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "当前自习记录没有代办清单！"
   }
   ```

   

### 获取云自习排行榜

> 请求地址：/studytime/ranking
>
> 请求方式：POST

| 请求参数 | 是否必填 | 类型 | 说明       | 备注                                               |
| -------- | -------- | ---- | ---------- | -------------------------------------------------- |
| type     | False    | int  | 排名的类别 | 1 代表根据总时长排名，<br />2 代表根据持续天数排名 |

**响应** 

1. 成功

   ```json
   {
       "status": 200,
       "data": [
           {
               "uid": 3,
               "name": "王五",
               "time": 1340,
               "continuou_day": 1,
               "createtime": "2022-01-10T03:43:25.000Z"
           },
       ]
   }
   ```

2. 失败

   ```json
   {
       "status": 0,
       "message": "排名无数据，请检查用户数据或自习记录数据！"
   }
   ```

